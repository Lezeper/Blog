!function(){angular.module("meanApp",["ngRoute","meanApp.admin","bw.paging","ui.tinymce"]).config(["$routeProvider","$locationProvider",function(t,e){t.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/p/:id",{templateUrl:"/post/post.view.html",controller:"postCtrl"}).when("/p",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),e.html5Mode(!0)}]).controller("mainCtrl",function(t){t.year=(new Date).getFullYear()}).filter("range",function(){return function(t,e){e=parseInt(e);for(var o=0;e>o;o++)t.push(o);return t}}).filter("sanitize",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).filter("sanitizeReadMore",["$sce",function(t){return function(e,o){return e.indexOf("<!--more-->")>-1&&(e=e.substring(0,e.indexOf("<!--more-->")),e+="<hr><h4><a href='/p/"+o+"'>Read More...</a></h4>"),t.trustAsHtml(e)}}]).controller("footerCtrl",["$scope",function(t){t.year=(new Date).getFullYear()}]),angular.module("meanApp.admin",[]).config(["$routeProvider",function(t){t.when("/admin",{templateUrl:"/admin/overview/admin.overview.view.html",controller:"adminCtrl",controllerAs:"vm"}).when("/admin/post",{templateUrl:"/admin/post/admin.post.view.html",controller:"adminPostCtrl",controllerAs:"vm"})}]).run(["$rootScope","$location","authentication",function(t,e,o){t.$on("$routeChangeStart",function(t,n,r){o.isLoggedIn()||"/admin"!==e.path()&&"/admin/post"!==e.path()||e.path("/")})}])}(),function(){angular.module("meanApp").controller("homeCtrl",["$scope","$routeParams","meanData","authentication","$rootScope",function(t,e,o,n,r){t.pageSize=5,r.$broadcast("showRightBar",!0),t.isLoggedIn=n.isLoggedIn();var i=function(e){if(t.totalPage=e/t.pageSize,t.totalSize=e,e>t.pageSize)for(var o=1;o<=t.pageSize;o++)t["isShowPost"+o]=!0;else for(var n=1;e>=n;n++)t["isShowPost"+n]=!0};e.category||e.keyword||e.tag||o.getAllPosts().success(function(e){t.posts=e,i(e.length)}),e.category&&o.getPostsByCategory(e.category).success(function(e){t.posts=e,i(e.length)}),e.keyword&&o.getPostsByKeyword(e.keyword).success(function(e){t.posts=e,i(e.length)}),e.tag&&o.getPostsByTag(e.tag).success(function(e){t.posts=e,i(e.length)}),t.changePage=function(e){for(var o=(e-1)*t.pageSize+1;o<=(e-1)*t.pageSize+t.pageSize;o++)t["isShowPost"+o]=!0;for(var n=1;n<=(e-1)*t.pageSize;n++)t["isShowPost"+n]=!1;for(var r=e*t.pageSize+1;r<=t.totalSize;r++)t["isShowPost"+r]=!1},t.$on("posts",function(e,o){t.posts=o,i(o.length)})}])}(),function(){angular.module("meanApp").controller("postCtrl",["$scope","$routeParams","meanData","$rootScope",function(t,e,o,n){n.$broadcast("showRightBar",!1),e.id&&o.getPostById(e.id).success(function(e){t.post=e}),t.prismHighlight=function(){Prism.highlightAll()}}])}(),function(){angular.module("meanApp").controller("adminCtrl",["$scope","$location","meanData","$rootScope",function(t,e,o,n){t.user={},n.$broadcast("showRightBar",!0),t.clearAllLogs=function(){o.clearAllLogs().success(function(){t.getAllLogs()})},t.views=t.getAllLogs=function(){o.getAllLogs().success(function(e){t.logs=e}).error(function(t){console.log(t)})}}])}(),function(){function t(t,e){var o=this;o.credentials={name:"",email:"",password:""},o.onSubmit=function(){console.log("Submitting registration"),e.register(o.credentials).error(function(t){alert(t)}).then(function(){t.path("profile")})}}angular.module("meanApp").controller("registerCtrl",t),t.$inject=["$location","authentication"]}(),function(){angular.module("meanApp").controller("loginCtrl",["$scope","$location","authentication","$rootScope",function(t,e,o,n){t.error=!1,n.$broadcast("showRightBar",!1),t.onSubmit=function(){o.login(t.credentials).error(function(){t.error=!0}).then(function(){window.location.href="/admin"})}}])}(),function(){function t(t,e){var o=function(t){e.localStorage["mean-token"]=t},n=function(){return e.localStorage["mean-token"]},r=function(){var t,o=n();return o?(t=o.split(".")[1],t=e.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3):!1},i=function(){if(r()){var t=n(),o=t.split(".")[1];return o=e.atob(o),o=JSON.parse(o),{email:o.email,name:o.name}}},a=function(e){return t.post("/api/register",e).success(function(t){o(t.token)})},s=function(e){return t.post("/api/login",e).success(function(t){o(t.token)})},c=function(){e.localStorage.removeItem("mean-token")};return{currentUser:i,saveToken:o,getToken:n,isLoggedIn:r,register:a,login:s,logout:c}}angular.module("meanApp").service("authentication",t),t.$inject=["$http","$window"]}(),function(){angular.module("meanApp").service("meanData",["$http","authentication",function(t,e){var o=function(){return t.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})},n=function(){return t.get("/api/post")},r=function(e){return t.get("/api/post/keyword/"+e)},i=function(e){return t.get("/api/post/id/"+e)},a=function(e){return t.get("/api/post/category/"+e)},s=function(e){return t.get("/api/post/tag/"+e)},c=function(){return t.get("/api/post/category")},l=function(){return t.get("/api/post/tag")},u=function(o){return t.post("/api/post/",o,{headers:{Authorization:"Bearer "+e.getToken()}})},g=function(o,n){return t.put("/api/post/id/"+o,n,{headers:{Authorization:"Bearer "+e.getToken()}})},p=function(o){return t["delete"]("/api/post/id/"+o,{headers:{Authorization:"Bearer "+e.getToken()}})},f=function(){return t.get("/api/log",{headers:{Authorization:"Bearer "+e.getToken()}})},m=function(){return t["delete"]("/api/log",{headers:{Authorization:"Bearer "+e.getToken()}})};return{getProfile:o,getAllPosts:n,getPostsByKeyword:r,getPostById:i,createPost:u,updatePost:g,destroyPost:p,listCategory:c,listTag:l,getPostsByCategory:a,getPostsByTag:s,getAllLogs:f,clearAllLogs:m}}])}(),function(){angular.module("meanApp").controller("adminPostCtrl",["$scope","$location","meanData","$routeParams","$rootScope",function(t,e,o,n,r){t.isShowPostsTable=!0,t.isShowAddPost=!1,t.isShowUpdatePost=!1,r.$broadcast("showRightBar",!0),n.eid&&o.getPostById(n.eid).success(function(e){t.updatePostData=e,t.isShowUpdatePost=!0,t.isShowPostsTable=!1}).error(function(t){alert(t.message)}),t.getAllPosts=function(){o.getAllPosts().success(function(e){t.posts=e}).error(function(t){alert(t.message)})},t.createPost=function(){o.createPost(t.newPost).success(function(){window.location.reload()}).error(function(t){alert(t.message)})},t.updatePost=function(e){o.updatePost(e,t.updatePostData).success(function(){window.location.reload()}).error(function(t){alert(t.message)})},t.destroyPost=function(e){confirm("Are you sure to remove this post?")&&o.destroyPost(e).success(function(){t.getAllPosts()}).error(function(t){alert(t.message)})},t.tinymceOptions={height:500,plugins:"link image codesample advlist code preview",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image",valid_elements:"*[*]"}}])}(),function(){function t(t,e,o){t.isLoggedIn=o.isLoggedIn(),t.currentUser=o.currentUser()}angular.module("meanApp").controller("navigationCtrl",t),t.$inject=["$scope","$location","authentication"]}(),function(){function t(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("meanApp").directive("navigation",t)}(),function(){angular.module("meanApp").controller("rightbarCtrl",["$scope","meanData","authentication","$rootScope",function(t,e,o,n){t.isLoggedIn=o.isLoggedIn(),t.showRightBar=!0,t.$on("showRightBar",function(e,o){t.showRightBar=o}),t.logout=function(){o.logout(),window.location.href="/"},t.search=function(){""!=t.keyword?e.getPostsByKeyword(t.keyword).success(function(t){n.$broadcast("posts",t)}):e.getAllPosts().success(function(t){n.$broadcast("posts",t)})},e.listCategory().success(function(e){t.categories=e}),e.listTag().success(function(e){t.tags=e})}])}(),function(){function t(){return{restrict:"EA",templateUrl:"/common/directives/rightbar/rightbar.template.html",controller:"rightbarCtrl"}}angular.module("meanApp").directive("rightbar",t)}();
//# sourceMappingURL=app.min.js.map
