!function(){angular.module("meanApp",["ngRoute","meanApp.admin","bw.paging","ui.tinymce"]).config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/p/:id",{templateUrl:"/post/post.view.html",controller:"postCtrl"}).when("/p",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),o.html5Mode(!0)}]).controller("mainCtrl",function(t){t.year=(new Date).getFullYear()}).filter("range",function(){return function(t,o){o=parseInt(o);for(var e=0;o>e;e++)t.push(e);return t}}).filter("sanitize",["$sce",function(t){return function(o){return t.trustAsHtml(o)}}]).filter("sanitizeReadMore",["$sce",function(t){return function(o,e){return o.indexOf("<!--more-->")>-1&&(o=o.substring(0,o.indexOf("<!--more-->")),o+="<hr><h4><a href='/p/"+e+"'>Read More...</a></h4>"),t.trustAsHtml(o)}}]).controller("footerCtrl",["$scope",function(t){t.year=(new Date).getFullYear()}]),angular.module("meanApp.admin",[]).config(["$routeProvider",function(t){t.when("/admin",{templateUrl:"/admin/overview/admin.overview.view.html",controller:"adminCtrl",controllerAs:"vm"}).when("/admin/post",{templateUrl:"/admin/post/admin.post.view.html",controller:"adminPostCtrl",controllerAs:"vm"})}]).run(["$rootScope","$location","authentication",function(t,o,e){t.$on("$routeChangeStart",function(t,n,r){e.isLoggedIn()||"/admin"!==o.path()&&"/admin/post"!==o.path()||o.path("/")})}])}(),function(){angular.module("meanApp").controller("homeCtrl",["$scope","$routeParams","meanData","authentication","$rootScope",function(t,o,e,n,r){t.pageSize=5,r.$broadcast("showRightBar",!0),t.isLoggedIn=n.isLoggedIn();var i=function(o){if(t.totalPage=o/t.pageSize,t.totalSize=o,o>t.pageSize)for(var e=1;e<=t.pageSize;e++)t["isShowPost"+e]=!0;else for(var n=1;o>=n;n++)t["isShowPost"+n]=!0};o.category||o.keyword||o.tag||e.getAllPosts().success(function(o){t.posts=o,i(o.length)}),o.category&&e.getPostsByCategory(o.category).success(function(o){t.posts=o,i(o.length)}),o.keyword&&e.getPostsByKeyword(o.keyword).success(function(o){t.posts=o,i(o.length)}),o.tag&&e.getPostsByTag(o.tag).success(function(o){t.posts=o,i(o.length)}),t.changePage=function(o){for(var e=(o-1)*t.pageSize+1;e<=(o-1)*t.pageSize+t.pageSize;e++)t["isShowPost"+e]=!0;for(var n=1;n<=(o-1)*t.pageSize;n++)t["isShowPost"+n]=!1;for(var r=o*t.pageSize+1;r<=t.totalSize;r++)t["isShowPost"+r]=!1},t.$on("posts",function(o,e){t.posts=e,i(e.length)})}])}(),function(){angular.module("meanApp").controller("postCtrl",["$scope","$routeParams","meanData","$rootScope",function(t,o,e,n){n.$broadcast("showRightBar",!1),o.id&&e.getPostById(o.id).success(function(o){t.post=o}),t.prismHighlight=function(){Prism.highlightAll()}}])}(),function(){angular.module("meanApp").controller("adminCtrl",["$scope","$location","meanData","$rootScope",function(t,o,e,n){t.user={},n.$broadcast("showRightBar",!0),e.getProfile().success(function(o){t.user=o}).error(function(t){console.log(t)})}])}(),function(){angular.module("meanApp").controller("adminPostCtrl",["$scope","$location","meanData","$routeParams","$rootScope",function(t,o,e,n,r){t.isShowPostsTable=!0,t.isShowAddPost=!1,t.isShowUpdatePost=!1,r.$broadcast("showRightBar",!0),e.getAllPosts().success(function(o){t.posts=o}).error(function(t){alert(t.message)}),n.eid&&e.getPostById(n.eid).success(function(o){t.updatePostData=o,t.isShowUpdatePost=!0,t.isShowPostsTable=!1}).error(function(t){alert(t.message)}),t.createPost=function(){e.createPost(t.newPost).success(function(){window.location.reload()}).error(function(t){alert(t.message)})},t.updatePost=function(o){e.updatePost(o,t.updatePostData).success(function(){window.location.reload()}).error(function(t){alert(t.message)})},t.destroyPost=function(t){confirm("Are you sure to remove this post?")&&e.destroyPost(t).success(function(){window.location.reload()}).error(function(t){alert(t.message)})},t.tinymceOptions={height:500,plugins:"link image codesample advlist code preview",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | bullist numlist | codesample | link image",valid_elements:"*[*]"}}])}(),function(){angular.module("meanApp").controller("loginCtrl",["$scope","$location","authentication","$rootScope",function(t,o,e,n){t.error=!1,n.$broadcast("showRightBar",!1),t.onSubmit=function(){e.login(t.credentials).error(function(){t.error=!0}).then(function(){window.location.href="/admin"})}}])}(),function(){function t(t,o){var e=this;e.credentials={name:"",email:"",password:""},e.onSubmit=function(){console.log("Submitting registration"),o.register(e.credentials).error(function(t){alert(t)}).then(function(){t.path("profile")})}}angular.module("meanApp").controller("registerCtrl",t),t.$inject=["$location","authentication"]}(),function(){function t(t,o){var e=function(t){o.localStorage["mean-token"]=t},n=function(){return o.localStorage["mean-token"]},r=function(){var t,e=n();return e?(t=e.split(".")[1],t=o.atob(t),t=JSON.parse(t),t.exp>Date.now()/1e3):!1},i=function(){if(r()){var t=n(),e=t.split(".")[1];return e=o.atob(e),e=JSON.parse(e),{email:e.email,name:e.name}}},a=function(o){return t.post("/api/register",o).success(function(t){e(t.token)})},s=function(o){return t.post("/api/login",o).success(function(t){e(t.token)})},c=function(){o.localStorage.removeItem("mean-token")};return{currentUser:i,saveToken:e,getToken:n,isLoggedIn:r,register:a,login:s,logout:c}}angular.module("meanApp").service("authentication",t),t.$inject=["$http","$window"]}(),function(){angular.module("meanApp").service("meanData",["$http","authentication",function(t,o){var e=function(){return t.get("/api/profile",{headers:{Authorization:"Bearer "+o.getToken()}})},n=function(){return t.get("/api/post")},r=function(o){return t.get("/api/post/keyword/"+o)},i=function(o){return t.get("/api/post/id/"+o)},a=function(o){return t.get("/api/post/category/"+o)},s=function(o){return t.get("/api/post/tag/"+o)},c=function(){return t.get("/api/post/category")},l=function(){return t.get("/api/post/tag")},u=function(e){return t.post("/api/post/",e,{headers:{Authorization:"Bearer "+o.getToken()}})},g=function(e,n){return t.put("/api/post/id/"+e,n,{headers:{Authorization:"Bearer "+o.getToken()}})},p=function(e){return t["delete"]("/api/post/id/"+e,{headers:{Authorization:"Bearer "+o.getToken()}})};return{getProfile:e,getAllPosts:n,getPostsByKeyword:r,getPostById:i,createPost:u,updatePost:g,destroyPost:p,listCategory:c,listTag:l,getPostsByCategory:a,getPostsByTag:s}}])}(),function(){function t(t,o,e){t.isLoggedIn=e.isLoggedIn(),t.currentUser=e.currentUser()}angular.module("meanApp").controller("navigationCtrl",t),t.$inject=["$scope","$location","authentication"]}(),function(){function t(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("meanApp").directive("navigation",t)}(),function(){angular.module("meanApp").controller("rightbarCtrl",["$scope","meanData","authentication","$rootScope",function(t,o,e,n){t.isLoggedIn=e.isLoggedIn(),t.showRightBar=!0,t.$on("showRightBar",function(o,e){t.showRightBar=e}),t.logout=function(){e.logout(),window.location.href="/"},t.search=function(){""!=t.keyword?o.getPostsByKeyword(t.keyword).success(function(t){n.$broadcast("posts",t)}):o.getAllPosts().success(function(t){n.$broadcast("posts",t)})},o.listCategory().success(function(o){t.categories=o}),o.listTag().success(function(o){t.tags=o})}])}(),function(){function t(){return{restrict:"EA",templateUrl:"/common/directives/rightbar/rightbar.template.html",controller:"rightbarCtrl"}}angular.module("meanApp").directive("rightbar",t)}();
//# sourceMappingURL=app.min.js.map
